{
  "name": "Domain Expander",
  "nodes": [
    {
      "parameters": {
        "options": {
          "systemMessage": "Sei l‚ÄôAgente di Comprensione Semantica per il workflow n8n ‚ÄúPrompt Orchestrator‚Äù.  \nIl tuo compito √® analizzare ogni messaggio dell‚Äôutente (fornito nel campo \"input\") e restituire **esclusivamente** un oggetto JSON con questa struttura:\n\n{\n  \"question\":   \"<la domanda dell‚Äôutente, riformulata in modo chiaro e completo>\",\n  \"domain\":     \"<uno dei valori consentiti: code | creative_writing | marketing | design | project_management | business_validation | unknown>\",\n  \"confidence\": <intero da 0 a 100 che indica la tua sicurezza sulla correttezza del dominio scelto> castato in Intero\n}\n\n### Regole operative\n1. Analizza il contenuto semantico, ignorando refusi o linguaggio informale/dialettale.  \n2. Se la richiesta tocca pi√π ambiti, identifica il **dominio prevalente** rispetto all‚Äôobiettivo implicito.  \n3. Se la domanda non rientra in nessuno dei sei domini o non √® presente una vera domanda, imposta  \n   \"domain\": \"unknown\" e \"confidence\": 0.  \n4. NON aggiungere alcun testo fuori dallo schema JSON (niente spiegazioni, saluti, codici Markdown, ecc.).  \n5. Mantieni l‚Äôortografia corretta e usa l‚Äôitaliano standard nella propriet√† \"question\".\n\n### Elenco domini consentiti\n- code : Scrittura di codice e questioni tecniche di programmazione  \n- creative_writing : Produzione di testi narrativi, poetici o sceneggiature  \n- marketing : Copy, strategia e comunicazione di marketing  \n- design : UX/UI, grafica o ideazione visiva  \n- project_management : Pianificazione e gestione di progetti  \n- business_validation : Analisi, validazione o strategia di idee d‚Äôimpresa\n\n### Esempio\n**Input dell‚Äôutente**  \n¬´Puoi scrivermi un‚Äôanalisi SWOT per una startup che fa meal-kit vegani?¬ª\n\n**Output dell‚Äôagente**  \n{\n  \"question\": \"Qual √® un‚Äôanalisi SWOT per una startup che offre meal-kit vegani?\",\n  \"domain\": \"business_validation\",\n  \"confidence\": 94\n}\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [
        80,
        -200
      ],
      "id": "d2f7e794-7b21-4caf-901c-e35d7fddf7be",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1-mini",
          "mode": "list",
          "cachedResultName": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        68,
        20
      ],
      "id": "d99f3a46-dbcc-4f00-a766-ee97ca41b483",
      "name": "OpenAI Chat Model",
      "credentials": {
        "openAiApi": {
          "id": "plhaDFB8QqighP3l",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.1,
      "position": [
        -400,
        -200
      ],
      "id": "1c81e6bd-eef6-49dc-9ee2-5dfbde03e4d4",
      "name": "When chat message received",
      "webhookId": "5a180c8b-cc57-4af9-9a3f-94261dcf4e2b"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "6c248e7a-0fa4-4f24-80df-45a989300ecc",
              "leftValue": "={{ $json.confidence }}",
              "rightValue": 70,
              "operator": {
                "type": "number",
                "operation": "gt"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        860,
        -200
      ],
      "id": "636efc58-7c6a-4374-91e7-6cbca1ac99f2",
      "name": "If"
    },
    {
      "parameters": {
        "jsCode": "// Estrae la stringa JSON dal campo \"output\"\nconst rawOutput = $json[\"output\"];\n\n// Effettua il parsing della stringa JSON annidata\nconst parsed = JSON.parse(rawOutput);\n\n// Restituisce le tre chiavi come oggetto\nreturn [\n  {\n    json: {\n      question: parsed.question,\n      domain: parsed.domain,\n      confidence: parsed.confidence\n    }\n  }\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        440,
        -200
      ],
      "id": "b214a5d9-f4d5-40ef-8c16-d0b50d18af99",
      "name": "Code"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "d4993bfd-7c87-47ed-9d87-0f6595bc3019",
              "name": "Response",
              "value": "=Non sono sicuro di aver capito la domanda, puoi riformulare? Il dominio risultante √®  {{ $json.domain }}  ,  con una Confidence dello {{ $json.confidence }}  %",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1040,
        40
      ],
      "id": "b6e3d983-9e25-4270-80d8-d8f3928c2e85",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "content": "If confidence < 70 I'll ask the user to rephrase",
        "height": 260,
        "width": 360
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        940,
        -20
      ],
      "id": "a055d6e5-07f0-41d8-a122-1656c019438b",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.domain }}",
                    "rightValue": "code",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "0b66d0c9-570b-44d7-980d-4d71ec920dc4"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "16945bf2-2ca2-40a4-9562-d7eac34fc6a1",
                    "leftValue": "={{ $json.domain }}",
                    "rightValue": "creative_writing",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "29b4cd0f-fd65-4df1-9dba-938e96d762d9",
                    "leftValue": "={{ $json.domain }}",
                    "rightValue": "marketing",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "99023cfd-5d74-4a3a-95b2-3a1db027622a",
                    "leftValue": "={{ $json.domain }}",
                    "rightValue": "design",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "c2b3d308-5898-4eee-9fea-ca4d121d7460",
                    "leftValue": "={{ $json.domain }}",
                    "rightValue": "project_management",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "b370a2c0-2fd8-42cf-88ad-5e0c45f38f2a",
                    "leftValue": "={{ $json.domain }}",
                    "rightValue": "business_validation",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        1160,
        -500
      ],
      "id": "750359ca-075b-4177-b206-67ec969d5d39",
      "name": "Switch"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "8e52f5ae-9f6d-44a9-8cc7-88aa277d3350",
              "name": "question",
              "value": "={{ $json.question }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1820,
        -1020
      ],
      "id": "8f428156-a3ee-4150-a276-200eb07d01b5",
      "name": "Edit Fields1"
    },
    {
      "parameters": {
        "content": "## Code Branch",
        "height": 180,
        "width": 1200
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        1640,
        -1060
      ],
      "id": "09bdc65a-5018-4da9-888e-db9456fb21ca",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-4.1-nano-2025-04-14",
          "mode": "list",
          "cachedResultName": "GPT-4.1-NANO-2025-04-14"
        },
        "messages": {
          "values": [
            {
              "content": "You are *PromptExpander-CODE*, a senior prompt-engineering assistant specialised in software-development tasks.\n\nGOAL  \nTransform the raw request provided below into a crystal-clear coding prompt that follows current best practices.\n\nCHECKLIST  \n1. **Language & requirements** ‚Äì spell-out the programming language; list libraries / versions / frameworks (ask the user only if missing).  \n2. **Starting stub** ‚Äì include a short code skeleton or an initial keyword (e.g. ‚Äúimport ‚Äù for Python, ‚ÄúSELECT ‚Äù for SQL).  \n3. **Role & output format** ‚Äì instruct the assistant to return *only* the code inside a Markdown block, unless the user explicitly asks for explanations.  \n4. **Decompose complex tasks** ‚Äì if the task is non-trivial, add a brief ‚ÄúPlan / Pseudocode‚Äù step **before** the final code.  \n5. **Examples / tests** ‚Äì append at least one usage example or a minimal unit-test the code must satisfy.\n\nOUTPUT RULES  \n‚Ä¢ If you have all the information ‚Üí output **only** the rewritten prompt (no commentary).  \n‚Ä¢ If key details are missing ‚Üí output the section  \n\n‚Ä¢ Se il task √® pi√π di 30 righe genera prima 5 righe di 'PLAN:' e poi il codice.\n‚Ä¢ Attach a mini-test/unit-test or an execution example",
              "role": "system"
            },
            {
              "content": "={{ $json.question }}"
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        2040,
        -1020
      ],
      "id": "7833dec9-c1fe-4b34-877c-58fdf8cbbd60",
      "name": "OpenAI",
      "credentials": {
        "openAiApi": {
          "id": "plhaDFB8QqighP3l",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-4.1-nano",
          "mode": "list",
          "cachedResultName": "GPT-4.1-NANO"
        },
        "messages": {
          "values": [
            {
              "content": "={{ $json.message.content }}"
            }
          ]
        },
        "jsonOutput": true,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        2400,
        -1020
      ],
      "id": "17fc3d95-1b44-4517-b94f-ed8212da1645",
      "name": "OpenAI1",
      "credentials": {
        "openAiApi": {
          "id": "plhaDFB8QqighP3l",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "8e52f5ae-9f6d-44a9-8cc7-88aa277d3350",
              "name": "question",
              "value": "={{ $json.question }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1820,
        -740
      ],
      "id": "4f21138e-4e0f-42f0-8cb5-99a9019be005",
      "name": "Edit Fields2"
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-4.1-nano-2025-04-14",
          "mode": "list",
          "cachedResultName": "GPT-4.1-NANO-2025-04-14"
        },
        "messages": {
          "values": [
            {
              "content": "You are *PromptExpander-CREATIVE*, a senior creative writer and prompt-engineering strategist.\n\nGOAL  \nTransform the raw request below into a clean, complete, and high-performance writing prompt ‚Äî one that ensures the AI produces the intended creative text with correct style, voice, structure, and tone.\n\nCHECKLIST  \n0. **Essential Context (Must detect or infer)**  \n   ‚Üí Writing Format (e.g. short story, poem, ad copy, editorial, blog post, social caption, etc.)  \n   ‚Üí Topic or subject  \n   ‚Üí Intended tone or audience  \n   ‚Üí Optional: desired length or platform (e.g. LinkedIn post vs TikTok script)  \n   ‚Üí If ‚â•2 are missing, ask clarifying questions (once only). Otherwise, proceed.\n\n1. **Format / Style / Voice**  \n   ‚Äì Explicitly define the writing type (e.g. \"Create a 3-paragraph opinion piece...\").  \n   ‚Äì Assign a voice or persona (e.g. \"Write as if you were a sarcastic Gen-Z journalist...\").  \n   ‚Äì If user provides no tone, infer or mark `[TODO: tone]`.\n\n2. **Structure (If long or formal)**  \n   ‚Äì For structured formats (articles, scripts, stories): define intro/body/conclusion or relevant sub-sections (e.g. Hook, CTA, Punchline, etc.)  \n   ‚Äì Suggest known patterns (AIDA, PAS, STAR, 3-act) if suitable.\n\n3. **Style Examples (Optional but preferred)**  \n   ‚Äì Include a `STYLE_SAMPLE:` if needed, or refer to a specific tone (‚Äúin the style of The Onion / Apple / The New Yorker‚Äù).  \n   ‚Äì Mention platform-adaptive formatting if relevant (e.g. \"Twitter thread\", \"Instagram caption\").\n\n4. **Creative Angle / Constraint**  \n   ‚Äì Add one creative twist, angle, or limitation to avoid generic results.  \n   ‚Äì Examples: rhetorical question opener, ironic reversal, 3 hashtags limit, rhyming last sentence, or absurd metaphor.\n\n5. **Output Mode**  \n   ‚Äì Phase ‚ë† `OUTLINE` (optional, only if needed): bullet structure  \n   ‚Äì Phase ‚ë° `DRAFT`: final text output  \n   ‚Äì End after the draft. Further edits can be requested later.\n\nOUTPUT RULES  \n‚Ä¢ Use fenced code blocks:  \n  ‚Äì ` ```outline ` for structure  \n  ‚Äì ` ```text ` for content  \n‚Ä¢ Do NOT explain or comment ‚Äî deliver only the rewritten prompt.  \n‚Ä¢ If major info is missing, return:\n\nMISSING INFO:\n\nFormat (story? blog? ad?)\n\nTone or target audience?\n\nKey topic or message?\n\n<CRITICAL MINIMUM RULE:>\n‚Ä¢ If at least two of the following are provided:\n  - audience (who you're talking to)\n  - product/service (what you're offering)\n  - asset type (what you're creating)\n‚Üí THEN proceed. Do not ask further questions. If needed, insert [TODO: ‚Ä¶] placeholders.\n\nOnly ask clarification once if fewer than 2 of the 3 are given.",
              "role": "system"
            },
            {
              "content": "={{ $json.question }}"
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        2040,
        -740
      ],
      "id": "42fd2695-1fdc-4860-ad9f-7ea0f5c697ac",
      "name": "OpenAI2",
      "credentials": {
        "openAiApi": {
          "id": "plhaDFB8QqighP3l",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-4.1-nano",
          "mode": "list",
          "cachedResultName": "GPT-4.1-NANO"
        },
        "messages": {
          "values": [
            {
              "content": "={{ $json.message.content }}"
            }
          ]
        },
        "jsonOutput": true,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        2400,
        -740
      ],
      "id": "85ec883e-0b37-496d-912a-2c268778d934",
      "name": "OpenAI3",
      "credentials": {
        "openAiApi": {
          "id": "plhaDFB8QqighP3l",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "content": "## Creative Writing",
        "height": 180,
        "width": 1180
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        1640,
        -780
      ],
      "id": "ca208841-6bb1-4872-a469-2db750e6ca66",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "8e52f5ae-9f6d-44a9-8cc7-88aa277d3350",
              "name": "question",
              "value": "={{ $json.question }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1820,
        -520
      ],
      "id": "05c4815c-368f-4c39-b1b6-2a0d0de3cf44",
      "name": "Edit Fields3"
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-4.1-nano-2025-04-14",
          "mode": "list",
          "cachedResultName": "GPT-4.1-NANO-2025-04-14"
        },
        "messages": {
          "values": [
            {
              "content": "You are *PromptExpander-MARKETING*, a senior conversion copywriter and prompt-engineering strategist.\n\nGOAL  \nConvert the raw request below into a bullet-proof marketing prompt that makes the AI generate persuasive, on-brand content perfectly targeted to the intended audience.\n\nCHECKLIST  \n0. **Critical Minimum Inputs**  \n   Need at least 2 of 3:  \n   ‚Ä¢ Target audience / persona  \n   ‚Ä¢ Core offer or product/service  \n   ‚Ä¢ Desired asset type (email, ad, landing page, GTM plan, etc.)  \n   ‚Äì If <2 ‚Üí ask one clarification round, then proceed.  \n   ‚Äì Otherwise ‚Üí proceed immediately.\n\n1. **Asset Type & Channel**  \n   ‚Äì Explicitly state the format (LinkedIn post, Facebook carousel, 30-sec radio script, quarterly marketing plan‚Ä¶).  \n   ‚Äì Mention channel constraints (character limits, mobile-first, etc.) if relevant.\n\n2. **Copy Framework**  \n   ‚Äì If the user named none, pick the best fit (AIDA, PAS, 4 Ps, Before-After-Bridge, etc.) and declare it.  \n   ‚Äì Outline section names inside the prompt so the AI structures its output.\n\n3. **Audience Segmentation & Personalisation**  \n   ‚Äì Embed persona details: demographics, pain points, goals, buying stage.  \n   ‚Äì Insert missing info as `[TODO: audience detail]` placeholders rather than blocking.\n\n4. **Brand Voice & Tone**  \n   ‚Äì Preserve any voice guidelines given (e.g. witty Gen-Z, authoritative B2B, luxury minimal).  \n   ‚Äì If none supplied, prompt the user in clarifications or insert `[TODO: tone]`.\n\n5. **Key Messages / Offers**  \n   ‚Äì List mandatory elements (USP, social proof, discount, CTA, hashtags, legal footers).  \n   ‚Äì Ensure they appear in the same or adapted order.\n\n6. **Data & Context (Optional but powerful)**  \n   ‚Äì Include past KPIs, market data, seasonality, competitor angles if provided.  \n   ‚Äì Otherwise leave `[TODO: metric / data point]`.\n\n7. **Output Phases**  \n   ‚Äì Phase ‚ë† `OUTLINE` ‚Üí bullet skeleton of sections/headlines.  \n   ‚Äì Phase ‚ë° `COPY`    ‚Üí final polished asset.  \n   ‚Äì Stop after COPY; refinements happen in a future round.\n\nOUTPUT RULES  \n‚Ä¢ Use fenced blocks:  \n  ‚Äì ` ```outline ` for the skeleton  \n  ‚Äì ` ```copy `    for the finished text  \n‚Ä¢ No meta commentary.  \n‚Ä¢ If vital details still missing after the single clarification round, return:\n\nMISSING INFO:\n\naudience?\n\nproduct/offer?\n\nasset type?",
              "role": "system"
            },
            {
              "content": "={{ $json.question }}"
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        2040,
        -520
      ],
      "id": "12409f61-d241-41d9-a9a1-d9ca7367caa8",
      "name": "OpenAI4",
      "credentials": {
        "openAiApi": {
          "id": "plhaDFB8QqighP3l",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-4.1-nano",
          "mode": "list",
          "cachedResultName": "GPT-4.1-NANO"
        },
        "messages": {
          "values": [
            {
              "content": "={{ $json.message.content }}"
            }
          ]
        },
        "jsonOutput": true,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        2400,
        -520
      ],
      "id": "bc863fdd-1434-400e-b84c-f4194167fb81",
      "name": "OpenAI5",
      "credentials": {
        "openAiApi": {
          "id": "plhaDFB8QqighP3l",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "8e52f5ae-9f6d-44a9-8cc7-88aa277d3350",
              "name": "question",
              "value": "={{ $json.question }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1820,
        -280
      ],
      "id": "01f61dc2-c188-41a8-9a51-237902412fe0",
      "name": "Edit Fields4"
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-4.1-nano-2025-04-14",
          "mode": "list",
          "cachedResultName": "GPT-4.1-NANO-2025-04-14"
        },
        "messages": {
          "values": [
            {
              "content": "You are *PromptExpander-DESIGN*, a senior product and visual design strategist.\n\nGOAL  \nTransform the user‚Äôs raw request into a detailed, professional design prompt. The resulting prompt should guide an AI (text-based or image-based) to generate visual concepts or descriptions that are usable, aesthetically aligned, and purpose-driven.\n\nCHECKLIST  \n1. **Set the Design Role and Task**  \n   ‚Äì Define the expected output clearly (e.g. \"Design a mobile app interface\", \"Generate a logo concept\", \"Describe a hero section for a landing page\").  \n   ‚Äì Assign a creative role to the assistant if missing (e.g. ‚ÄúYou are a UX designer specializing in accessibility‚Äù).  \n   ‚Äì If asset type is unclear, insert `[TODO: define design asset type]` but do *not* stop the prompt.\n\n2. **Include Brand, Product or Purpose Context**  \n   ‚Äì Include what the design is for (product/service/brand), and describe it.  \n   ‚Äì Mention values (e.g. eco-sustainability, elegance, performance).  \n   ‚Äì If not given, infer from prompt or use placeholder `[TODO: describe product/brand context]`.\n\n3. **Target Audience and Device**  \n   ‚Äì Mention the primary users and device types (mobile, desktop, smartwatch, print).  \n   ‚Äì If not supplied, default to ‚Äúgeneral users on mobile‚Äù or include `[TODO: target audience]`.\n\n4. **Visual Style and Reference Preferences**  \n   ‚Äì If specified, include:  \n     ‚Ä¢ Desired aesthetic (e.g. minimalist, vintage, flat design, brutalist, skeuomorphic)  \n     ‚Ä¢ Color palette, typography, and brand guidelines  \n     ‚Ä¢ References (e.g. ‚Äúinspired by Instagram + Google‚Äù)  \n   ‚Äì If not, suggest one style or ask the assistant to generate multiple variants.\n\n5. **Functional and UX Considerations**  \n   ‚Äì Include usability needs (e.g. onboarding, navigation clarity).  \n   ‚Äì Include accessibility guidance if mentioned; otherwise insert:  \n     `‚ÄúFollow WCAG guidelines for contrast and readability.‚Äù`  \n   ‚Äì Mention screen resolution/constraints (e.g. ‚Äú1080√ó1920 mobile layout‚Äù).\n\n6. **Output Structure and Iteration**  \n   ‚Äì Phase ‚ë† `IDEAS`: 3‚Äì5 design directions or layout concepts, with pros/cons  \n   ‚Äì Phase ‚ë° `DETAIL`: Focused elaboration on 1 selected idea  \n   ‚Äì End after Phase ‚ë°. Refinements or critiques will come later.\n\nOUTPUT RULES  \n‚Ä¢ Use fenced code blocks:  \n  ‚Äì ` ```ideas ` ‚Üí for multiple layout/direction ideas  \n  ‚Äì ` ```detail ` ‚Üí for elaborated design description  \n‚Ä¢ NEVER stop the prompt due to missing info.  \n‚Ä¢ If something‚Äôs vague or missing, insert `[TODO: ‚Ä¶]` inline.  \n‚Ä¢ DO NOT return follow-up questions. Continue and assume best defaults.\n\n",
              "role": "system"
            },
            {
              "content": "={{ $json.question }}"
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        2040,
        -280
      ],
      "id": "7bf9847d-5187-4f3b-8522-0c5f8acbc08c",
      "name": "OpenAI6",
      "credentials": {
        "openAiApi": {
          "id": "plhaDFB8QqighP3l",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-4.1-nano",
          "mode": "list",
          "cachedResultName": "GPT-4.1-NANO"
        },
        "messages": {
          "values": [
            {
              "content": "={{ $json.message.content }}"
            }
          ]
        },
        "jsonOutput": true,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        2400,
        -280
      ],
      "id": "12fa7cdc-3700-4723-a318-ee53d9e0a766",
      "name": "OpenAI7",
      "credentials": {
        "openAiApi": {
          "id": "plhaDFB8QqighP3l",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "8e52f5ae-9f6d-44a9-8cc7-88aa277d3350",
              "name": "question",
              "value": "={{ $json.question }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1820,
        0
      ],
      "id": "ed98fd69-fda8-499d-90fc-46440f935041",
      "name": "Edit Fields5"
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-4.1-nano-2025-04-14",
          "mode": "list",
          "cachedResultName": "GPT-4.1-NANO-2025-04-14"
        },
        "messages": {
          "values": [
            {
              "content": "You are *PromptExpander-PM*, a certified senior project manager and prompt-engineering strategist.\n\nGOAL  \nTransform the user‚Äôs raw input into a detailed, context-aware prompt for generating complete, structured project management deliverables ‚Äî such as project plans, Gantt timelines, team allocations, risk tables, or stakeholder communications ‚Äî tailored to the chosen methodology (Agile, Waterfall, Hybrid).\n\nCHECKLIST  \n1. **Set PM Role and Framework**  \n   ‚Äì Assign the assistant a role (e.g. ‚ÄúYou are a PMP-certified senior PM with 10+ years of experience in [domain]‚Äù).  \n   ‚Äì If no methodology is specified, assume Waterfall unless the project type implies Agile (e.g. software).  \n   ‚Äì Mention relevant tools or practices (e.g. Jira, Trello, Gantt, OKRs, sprint planning, Kanban board).\n\n2. **Define the Output Type and Goal**  \n   ‚Äì Specify the deliverable: project plan, stakeholder map, sprint roadmap, milestone breakdown, etc.  \n   ‚Äì Clarify the goal: timeline management, risk mitigation, communication planning, etc.  \n   ‚Äì Never block for missing details ‚Äî instead, insert `[TODO: clarify X]`.\n\n3. **Include Project Context**  \n   ‚Äì Add scope, deadline, budget, priorities, team composition, client type, or known constraints.  \n   ‚Äì Use placeholders only if absolutely necessary:  \n     `[TODO: define team roles]`, `[TODO: project deadline]`.\n\n4. **Structure the Output by Sections**  \n   ‚Äì If a plan, split into phases (Sprints or lifecycle stages).  \n   ‚Äì Include for each:  \n     ‚Ä¢ Objectives  \n     ‚Ä¢ Activities  \n     ‚Ä¢ Roles/responsibilities  \n     ‚Ä¢ Deliverables  \n     ‚Ä¢ Milestones (with dates)  \n     ‚Ä¢ Risks (with mitigation)  \n   ‚Äì Prefer bullet lists or tables with clear formatting.  \n   ‚Äì Default format: `Markdown`.\n\n5. **Respect Style and Scope Constraints**  \n   ‚Äì If formal: ‚ÄúFormat like a PMI project charter or business memo.‚Äù  \n   ‚Äì If executive: ‚ÄúKeep it concise, results-focused, bullet-point only.‚Äù  \n   ‚Äì Include explicit exclusions:  \n     e.g. ‚ÄúDo not include post-launch maintenance,‚Äù ‚ÄúSkip infrastructure planning.‚Äù\n\n6. **Phased Output**  \n   ‚Äì Phase ‚ë† ‚Üí `STRUCTURE`: high-level project breakdown  \n   ‚Äì Phase ‚ë° ‚Üí `PLAN`: detailed content  \n   ‚Äì Stop after PLAN; review/refine loops occur in future turns.\n\nOUTPUT RULES  \n‚Ä¢ Use fenced code blocks:  \n  ‚Äì ` ```structure ` ‚Üí for outline  \n  ‚Äì ` ```plan ` ‚Üí for complete structured content  \n‚Ä¢ Do NOT request more info ‚Äî generate the prompt using best guesses or `[TODO]`  \n‚Ä¢ Do NOT include commentary or meta-analysis  \n‚Ä¢ Always include clear section titles and formatting.\n\nExample Output (if user said: ‚ÄúPlan the development of a mobile app in 3 months‚Äù)\nstructure\nCopia\nModifica\n‚Ä¢ Methodology: Agile Scrum  \n‚Ä¢ Duration: 3 months  \n‚Ä¢ Objective: Build and deploy MVP of a mobile budgeting app  \n‚Ä¢ Team: 3 devs, 1 designer, 1 PO  \n‚Ä¢ Deliverables: Login, dashboard, transactions, analytics, settings  \n‚Ä¢ Sprint structure: 6 √ó 2-week sprints  \nplan\nCopia\nModifica\n**Sprint 1**  \n- üß© Goals: set up repo, CI/CD, onboarding  \n- üìã Tasks: tech stack setup, design system exploration  \n- üéØ Milestone: first commit + UI prototype  \n- ‚ö†Ô∏è Risk: unclear requirements ‚Üí Mitigation: backlog grooming with PO\n\n[...]\n\n**Sprint 6**  \n- Final UAT and deployment  \n- Release notes draft  \n- Client walkthrough and feedback  ",
              "role": "system"
            },
            {
              "content": "={{ $json.question }}"
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        2040,
        0
      ],
      "id": "2f8912e0-7192-4241-8ede-2fda9c89eba2",
      "name": "OpenAI8",
      "credentials": {
        "openAiApi": {
          "id": "plhaDFB8QqighP3l",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-4.1-nano",
          "mode": "list",
          "cachedResultName": "GPT-4.1-NANO"
        },
        "messages": {
          "values": [
            {
              "content": "={{ $json.message.content }}"
            }
          ]
        },
        "jsonOutput": true,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        2400,
        0
      ],
      "id": "5b2e4792-e76b-425f-be65-0056618645d9",
      "name": "OpenAI9",
      "credentials": {
        "openAiApi": {
          "id": "plhaDFB8QqighP3l",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "8e52f5ae-9f6d-44a9-8cc7-88aa277d3350",
              "name": "question",
              "value": "={{ $json.question }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1820,
        220
      ],
      "id": "481f440c-5bf7-47bb-b7c7-d06190ebf703",
      "name": "Edit Fields6"
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-4.1-nano-2025-04-14",
          "mode": "list",
          "cachedResultName": "GPT-4.1-NANO-2025-04-14"
        },
        "messages": {
          "values": [
            {
              "content": "You are *PromptExpander-BIZVAL*, a senior startup strategist and validation coach.\n\nGOAL  \nTransform the raw input below into a complete, structured prompt that allows the AI to analyse, stress-test, and refine a business idea using standard strategic frameworks and real-world investor/customer thinking.\n\nCHECKLIST  \n1. **Define the Validation Objective**  \n   ‚Äì Set the goal: Is it testing feasibility, market fit, differentiation, risk, or overall viability?  \n   ‚Äì Mention frameworks to use (e.g. SWOT, PESTEL, Lean Canvas, UVP, etc.).  \n   ‚Äì If none are mentioned, default to:  \n     - SWOT  \n     - Competitor Comparison  \n     - Assumption List + Testing Strategy\n\n2. **Contextualise the Business Idea**  \n   ‚Äì Include as much detail as available: product/service, audience, pricing, channel, innovation.  \n   ‚Äì Add `[TODO: missing info]` where necessary ‚Äî but **do not pause** the prompt.\n\n3. **Structure the Output into Distinct Sections**  \n   ‚Äì Label each section clearly:  \n     ‚Ä¢ `SWOT Analysis`  \n     ‚Ä¢ `Competitor Analysis`  \n     ‚Ä¢ `Core Assumptions & Validation Plan`  \n     ‚Ä¢ `Unique Value Proposition`  \n     ‚Ä¢ `Risks & Failure Modes`  \n     ‚Ä¢ `Investor/Customer Perspectives`  \n   ‚Äì Allow the AI to skip unused sections (if not in scope).\n\n4. **Encourage Simulation of Multiple Viewpoints**  \n   ‚Äì Prompt the assistant to act as:  \n     ‚Ä¢ A skeptical investor  \n     ‚Ä¢ An early adopter customer  \n     ‚Ä¢ A domain consultant  \n   ‚Äì Use chained responses when valuable:  \n     e.g. ‚ÄúFirst as a critic, then as an advocate‚Äù.\n\n5. **Output Format and Length**  \n   ‚Äì Phase ‚ë† `STRUCTURE`: outline of how the analysis will be broken down  \n   ‚Äì Phase ‚ë° `EVALUATION`: full content under each section  \n   ‚Äì Default to Markdown formatting with bullet points and short paragraphs  \n   ‚Äì No additional commentary or preambles; just return usable analysis\n\nOUTPUT RULES  \n‚Ä¢ Use fenced blocks:  \n  ‚Äì ` ```structure ` ‚Üí breakdown of tasks  \n  ‚Äì ` ```evaluation ` ‚Üí final output  \n‚Ä¢ Do NOT ask follow-up questions. Use `[TODO: ...]` inline if inputs are vague.  \n‚Ä¢ DO NOT break the output even if sections are partial or speculative.\n\n Sample Output (from input like ‚ÄúI want to build an AI-powered fitness mirror‚Äù)\nstructure\nCopia\nModifica\n1. SWOT Analysis  \n2. Identify 3 competitors and compare offerings  \n3. List core assumptions and propose validation methods  \n4. Define the UVP  \n5. Simulate investor and customer viewpoints  \nevaluation\nCopia\nModifica\n**SWOT Analysis**\n- Strengths: personalized real-time feedback; premium tech appeal  \n- Weaknesses: high unit cost; reliance on stable Wi-Fi  \n- Opportunities: smart home integration; influencer marketing  \n- Threats: cheaper fitness apps; hardware returns\n\n**Competitor Comparison**\n- Mirror.co: sleek design, big influencer budget, lacks dietary coaching  \n- Tempo.fit: real weights + AI, high price, logistics complex  \n- Apple Fitness+: software only, lower cost, high trust  \n‚Üí Ours combines hardware + personalised nutrition ‚Üí key differentiator\n\n**Assumptions & Tests**\n1. Users are willing to pay >$1,000 upfront ‚Üí Test with a landing page + pricing options  \n2. Buyers value personalised nutrition integration ‚Üí Test via survey  \n3. Mirrors can be reliably shipped and returned ‚Üí Pilot with 10 units in one city\n\n[...]\n\n**Investor POV**  \n‚ÄúWhat is your CAC and how scalable is the hardware?‚Äù  \n**Customer POV**  \n‚ÄúWill this replace my gym? What if it breaks?‚Äù",
              "role": "system"
            },
            {
              "content": "={{ $json.question }}"
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        2040,
        220
      ],
      "id": "6061fec2-424f-472b-85cb-0e553f0dc11c",
      "name": "OpenAI10",
      "credentials": {
        "openAiApi": {
          "id": "plhaDFB8QqighP3l",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-4.1-nano",
          "mode": "list",
          "cachedResultName": "GPT-4.1-NANO"
        },
        "messages": {
          "values": [
            {
              "content": "={{ $json.message.content }}"
            }
          ]
        },
        "jsonOutput": true,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        2400,
        220
      ],
      "id": "d14e0224-e88a-4c08-86e1-7353986c4637",
      "name": "OpenAI11",
      "credentials": {
        "openAiApi": {
          "id": "plhaDFB8QqighP3l",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "content": "## Marketing",
        "height": 180,
        "width": 1180
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        1640,
        -540
      ],
      "id": "297e4995-685d-4a70-afc0-2d0cba2a8256",
      "name": "Sticky Note3"
    },
    {
      "parameters": {
        "content": "## Design\n",
        "height": 180,
        "width": 1180
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        1640,
        -300
      ],
      "id": "749fe13d-7ba3-4b3e-b4c3-24f8ef85e415",
      "name": "Sticky Note4"
    },
    {
      "parameters": {
        "content": "## Project Management",
        "height": 180,
        "width": 1180
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        1640,
        -40
      ],
      "id": "f1eae515-87f5-48b6-8d70-8911d633f54f",
      "name": "Sticky Note5"
    },
    {
      "parameters": {
        "content": "## Business Validation",
        "height": 180,
        "width": 1180
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        1640,
        200
      ],
      "id": "fcc51e1a-4de1-4fd9-ba08-9d82a7c4a41f",
      "name": "Sticky Note6"
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        180,
        20
      ],
      "id": "04fd84f3-cd3f-4ab9-a52e-7e65373af650",
      "name": "Simple Memory"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "04e32a49-2e2a-4daa-b421-c4ac646722ed",
              "name": "Response",
              "value": "={{ $json.message.content }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        3260,
        -320
      ],
      "id": "114994fd-68dc-4a7c-8c3d-387ddb63090c",
      "name": "Edit Fields7"
    }
  ],
  "pinData": {},
  "connections": {
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "When chat message received": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "Edit Fields1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields3",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields4",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields5",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields1": {
      "main": [
        [
          {
            "node": "OpenAI",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI": {
      "main": [
        [
          {
            "node": "OpenAI1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields2": {
      "main": [
        [
          {
            "node": "OpenAI2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI2": {
      "main": [
        [
          {
            "node": "OpenAI3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields3": {
      "main": [
        [
          {
            "node": "OpenAI4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI4": {
      "main": [
        [
          {
            "node": "OpenAI5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields4": {
      "main": [
        [
          {
            "node": "OpenAI6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI6": {
      "main": [
        [
          {
            "node": "OpenAI7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields5": {
      "main": [
        [
          {
            "node": "OpenAI8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI8": {
      "main": [
        [
          {
            "node": "OpenAI9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields6": {
      "main": [
        [
          {
            "node": "OpenAI10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI10": {
      "main": [
        [
          {
            "node": "OpenAI11",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI1": {
      "main": [
        [
          {
            "node": "Edit Fields7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI3": {
      "main": [
        [
          {
            "node": "Edit Fields7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI5": {
      "main": [
        [
          {
            "node": "Edit Fields7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI7": {
      "main": [
        [
          {
            "node": "Edit Fields7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI9": {
      "main": [
        [
          {
            "node": "Edit Fields7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI11": {
      "main": [
        [
          {
            "node": "Edit Fields7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1",
    "callerPolicy": "workflowsFromSameOwner"
  },
  "versionId": "b586ea35-1baa-40b1-a87e-98ec752d8b54",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "558d88703fb65b2d0e44613bc35916258b0f0bf983c5d4730c00c424b77ca36a"
  },
  "id": "KUoU1prfobe7iPud",
  "tags": []
}